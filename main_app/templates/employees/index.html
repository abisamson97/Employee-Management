{% extends 'base.html' %} {% block content %}

<h1>List of Employees</h1>

<form method="get" action="{% url 'index' %}">
  <label for="skill">Filter by Skill:</label>
  <select name="skill" id="skill">
    <option value="" selected>All Skills</option>
    {% for skill in skills.all %}
    <option value="{{ skill.id }}">{{ skill.name }}</option>
    {% endfor %}
  </select>

  <label for="position">Filter by Position:</label>
  <select name="position" id="position">
    <option value="" selected>All Positions</option>
    {% for position in positions.all %}
    <option value="{{ position.id }}">{{ position.name }}</option>
    {% endfor %}
  </select>

  <button class="btn modal-trigger" data-target="employeeModal" type="submit">
    Filter
  </button>
</form>

{% for employee in employees %}
<a href="/employees/{{ employee.id }}">
  <div class="card">
    <div class="card-content">
      <span class="card-title">{{ employee.name }}</span>
    </div>
  </div>
</a>
{% endfor %}
<div id="employeeModal" class="modal">
  <div class="modal-content">
    {% if filtered_employees %}
    <h2>Filtered Employees</h2>
    <ul>
      {% for emp in filtered_employees %}
      <li><a href="{{ emp.get_absolute_url }}">{{ emp.name }}</a></li>
      {% endfor %}
    </ul>
    {% endif %}
    <ul id="filteredEmployeesList">
      <!-- Filtered employee details will be loaded here via JavaScript -->
    </ul>
  </div>
</div>

<script>
  const filterEl = document.getElementById("position");
  M.FormSelect.init(filterEl);

  document.addEventListener("DOMContentLoaded", function () {
    var elems = document.querySelectorAll(".modal");
    var instances = M.Modal.init(elems);

    // Click event for the filter button
    $(".modal-trigger").click(function () {
      // Load filtered employee details via AJAX and populate the modal content
      $.get("/path/to/your/filtered-employees-endpoint", function (data) {
        // Assuming data is a list of filtered employees
        var filteredEmployees = data.filteredEmployees;

        // Clear existing content
        $("#filteredEmployeesList").empty();

        // Populate the modal content with filtered employee details
        filteredEmployees.forEach(function (emp) {
          $("#filteredEmployeesList").append("<li>" + emp.name + "</li>");
        });

        // Open the modal
        var modalInstance = M.Modal.getInstance($("#employeeModal"));
        modalInstance.open();
      });
    });
  });
</script>

{% endblock %}
